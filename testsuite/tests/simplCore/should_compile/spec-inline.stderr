
==================== Tidy Core ====================
Result size of Tidy Core
  = {terms: 57, types: 17, coercions: 0, joins: 1/1}

-- RHS size: {terms: 48, types: 11, coercions: 0, joins: 1/1}
Roman.$wfoo [InlPrag=[2]] :: Int -> GHC.Prim.Int#
[GblId[StrictWorker([!])],
 Arity=1,
 Str=<1L>,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [20] 78 0}]
Roman.$wfoo
  = \ (n :: Int) ->
      case n of { GHC.Types.I# ipv ->
      joinrec {
        $sgo [Occ=LoopBreaker, Dmd=SC(S,C(1,L))]
          :: GHC.Prim.Int# -> GHC.Prim.Int# -> GHC.Prim.Int#
        [LclId[JoinId(2)(Nothing)], Arity=2, Str=<A><L>, Unf=OtherCon []]
        $sgo (sc :: GHC.Prim.Int#) (sc1 :: GHC.Prim.Int#)
          = case GHC.Prim.<=# sc1 0# of {
              __DEFAULT ->
                case GHC.Prim.<# sc1 100# of {
                  __DEFAULT ->
                    case GHC.Prim.<# sc1 500# of {
                      __DEFAULT -> jump $sgo (GHC.Prim.*# 14# sc) (GHC.Prim.-# sc1 1#);
                      1# -> jump $sgo (GHC.Prim.*# 7# sc) (GHC.Prim.-# sc1 3#)
                    };
                  1# -> jump $sgo sc (GHC.Prim.-# sc1 2#)
                };
              1# -> 0#
            }; } in
      jump $sgo 6# ipv
      }

-- RHS size: {terms: 7, types: 2, coercions: 0, joins: 0/0}
foo [InlPrag=[2]] :: Int -> Int
[GblId,
 Arity=1,
 Str=<1L>,
 Cpr=1,
 Unf=Unf{Src=StableSystem, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (n [Occ=Once1] :: Int) ->
                 case Roman.$wfoo n of ww [Occ=Once1] { __DEFAULT ->
                 GHC.Types.I# ww
                 }}]
foo
  = \ (n :: Int) ->
      case Roman.$wfoo n of ww { __DEFAULT -> GHC.Types.I# ww }



